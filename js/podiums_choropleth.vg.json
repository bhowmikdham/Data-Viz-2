{
  "$schema": "https://vega.github.io/schema/vega-lite/v5.json",
  "title": {
    "text": "McLaren F1 Podiums by Country",
    "anchor": "start",
    "color": "#f5f5f7"
  },
  "width": 980,
  "height": 560,
  "background": "#0b0b0c",
  "projection": { "type": "mercator" },

  "params": [
  {
    "name": "metric",
    "value": "Podiums",
    "bind": {
      "input": "select",
      "name": "Show: ",
      "options": ["Podiums","Wins","Second","Third"],
      "element": "#map-controls"
    }
  }
],


  "layer": [
    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/2_symbol_map/js/ne_110m_admin_0_countries.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
      },
      "mark": { "type": "geoshape", "fill": "#161619", "stroke": "#1f1f22", "strokeWidth": 0.5 }
    },

    {
      "data": {
        "url": "https://raw.githubusercontent.com/FIT3179/Vega-Lite/main/2_symbol_map/js/ne_110m_admin_0_countries.topojson",
        "format": { "type": "topojson", "feature": "ne_110m_admin_0_countries" }
      },
      "transform": [
        {
          "calculate": "datum.properties.ADMIN === 'United States of America' ? 'United States' : datum.properties.ADMIN",
          "as": "ADMIN_FIX"
        },
        {
          "lookup": "ADMIN_FIX",
          "from": {
            "data": { "url": "data/mclaren_podiums.csv" },
            "key": "Country",
            "fields": ["Podiums", "Wins", "Second", "Third"]
          }
        },
        { "calculate": "isValid(datum[metric]) ? datum[metric] : null", "as": "metricValue" }
      ],
      "mark": { "type": "geoshape", "stroke": "#1f1f22", "strokeWidth": 0.5 },
      "encoding": {
        "color": {
          "field": "metricValue",
          "type": "quantitative",
          "title": {"expr": "metric"},
          "scale": { "range": ["#1a1a1d", "#481216", "#8d1b22", "#c2282f", "#ff3b3b"] }
        },
        "tooltip": [
          { "field": "ADMIN_FIX", "title": "Country" },
          { "field": "Podiums" },
          { "field": "Wins" },
          { "field": "Second" },
          { "field": "Third" }
        ]
      }
    }
  ],

  "config": {
    "view": { "stroke": null, "fill": "#0b0b0c" },
    "legend": { "orient": "bottom", "labelColor": "#e6e6e8", "titleColor": "#e6e6e8" },
    "axis": { "labelColor": "#d9d9db", "titleColor": "#d9d9db" }
  }
}
